"use strict";const finderInput=document.querySelector(".js-finder"),finderBtn=document.querySelector(".js-finder-btn"),searchListUl=document.querySelector(".js-search-list"),searchListText=document.querySelector(".js-coincidences_text"),resetBtn=document.querySelector(".js-reset-btn");let searchList=[];const savedFavs=JSON.parse(localStorage.getItem("myfavorites"));let favsList=savedFavs;function handleClick(e){e.preventDefault;const t=finderInput.value;fetch("//api.tvmaze.com/search/shows?q="+t).then(e=>e.json()).then(e=>{searchList=e,0===e.length?searchListText.innerHTML="Uy, parece que no tenemos ninguna coincidencia :(":searchListText.innerHTML="Aquí están tus coincidencias:",renderSearchList(searchList)})}function renderSearchList(e){searchListUl.innerHTML="";for(const t of e){const e=document.createElement("li");searchListUl.appendChild(e);const s=document.createElement("article");e.appendChild(s),s.setAttribute("id",t.show.id),s.classList.add("show_card");void 0!==favsList.find(e=>t.show.id===e.show.id)&&s.classList.add("show_card--fav");const n=document.createElement("img");null===t.show.image?n.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"):n.setAttribute("src",t.show.image.medium),n.setAttribute("alt","cartel"),s.appendChild(n);const i=document.createElement("h3"),c=document.createTextNode(t.show.name);i.appendChild(c),s.appendChild(i),s.addEventListener("click",clickFavs)}}function renderFavsList(){const e=document.querySelector(".favs_list");e.innerHTML="";for(const t of favsList){const s=document.createElement("li");s.setAttribute("id",t.show.id),e.appendChild(s),s.classList.add("show_card__fav");const n=document.createElement("img");null===t.show.image?n.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"):n.setAttribute("src",t.show.image.medium),n.setAttribute("alt","cartel"),s.appendChild(n);const i=document.createElement("h3"),c=document.createTextNode(t.show.name);i.appendChild(c),s.appendChild(i);const a=document.createElement("button"),r=document.createTextNode("X");a.appendChild(r),s.appendChild(a),a.classList.add("delete-btn"),a.showId=t.show.id,a.addEventListener("click",removeFav)}}function removeFav(e){e.preventDefault();const t=e.currentTarget.showId,s=favsList.findIndex(e=>t===e.show.id);favsList.splice(s,1),renderFavsList(),renderSearchList(searchList),storeFavs()}function removeAllFavs(){favsList=[],renderFavsList(),renderSearchList(searchList),storeFavs()}function clickFavs(e){const t=e.currentTarget.id,s=searchList.find(e=>e.show.id.toString()===t),n=favsList.find(e=>s.show.id===e.show.id);if(void 0===n)favsList.push(s);else{const e=favsList.indexOf(n);favsList.splice(e,1)}renderFavsList(),renderSearchList(searchList),storeFavs()}function storeFavs(){localStorage.setItem("myfavorites",JSON.stringify(favsList))}null===savedFavs&&(favsList=[]),renderFavsList(),finderBtn.addEventListener("click",handleClick),resetBtn.addEventListener("click",removeAllFavs);